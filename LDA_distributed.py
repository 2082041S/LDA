import multiprocessing.managers
import multiprocessing
from multiprocessing import Queue
from multiprocessing.managers import SyncManager
import time
from functools import partial
from Queue import Queue as _Queue
import numpy as np
#from sklearn.preprocessing import normalize
from LDA_Object import ldaObject


corpus = [[{'king': 3, 'goal': 2, 'pawn': 2, 'cinema': 4, 'TV': 1, 'movie': 3, 'government': 2, 'football': 3, 'actor': 2, 'goalkeeper': 4, 'books': 3, 'student': 2, 'president': 4, 'vote': 3, 'lecture': 1, 'bishop': 5, 'exam': 6}, {'king': 3, 'bishop': 2, 'exam': 3, 'cinema': 2, 'TV': 2, 'knight': 2, 'government': 3, 'football': 2, 'actor': 6, 'corruption': 1, 'penalty': 1, 'books': 2, 'student': 3, 'president': 5, 'vote': 4, 'lecture': 3, 'goalkeeper': 2, 'goal': 4}, {'king': 3, 'movie': 1, 'goal': 3, 'pawn': 3, 'cinema': 1, 'TV': 5, 'knight': 3, 'government': 4, 'football': 1, 'actor': 6, 'goalkeeper': 2, 'penalty': 2, 'books': 2, 'lecture': 1, 'vote': 5, 'president': 3, 'bishop': 1, 'exam': 4}, {'king': 2, 'movie': 1, 'bishop': 2, 'goal': 5, 'pawn': 4, 'cinema': 5, 'TV': 1, 'knight': 1, 'government': 1, 'football': 4, 'corruption': 3, 'penalty': 2, 'books': 1, 'student': 4, 'lecture': 1, 'vote': 1, 'president': 3, 'goalkeeper': 7, 'exam': 2}, {'king': 6, 'bishop': 1, 'exam': 4, 'pawn': 5, 'government': 2, 'TV': 3, 'knight': 1, 'football': 7, 'actor': 3, 'corruption': 2, 'penalty': 2, 'books': 1, 'cinema': 1, 'student': 3, 'lecture': 3, 'vote': 2, 'president': 2, 'goalkeeper': 2}, {'king': 3, 'movie': 2, 'goal': 3, 'pawn': 5, 'government': 3, 'TV': 4, 'knight': 1, 'football': 5, 'actor': 3, 'corruption': 1, 'books': 4, 'cinema': 4, 'student': 3, 'president': 3, 'vote': 1, 'lecture': 3, 'bishop': 1, 'exam': 1}, {'king': 2, 'president': 1, 'goal': 2, 'pawn': 1, 'cinema': 3, 'TV': 3, 'movie': 3, 'government': 5, 'football': 4, 'actor': 3, 'bishop': 1, 'penalty': 2, 'corruption': 3, 'books': 4, 'student': 1, 'knight': 2, 'vote': 2, 'lecture': 1, 'goalkeeper': 3, 'exam': 4}, {'goalkeeper': 4, 'exam': 3, 'pawn': 2, 'government': 2, 'TV': 7, 'movie': 2, 'football': 4, 'actor': 9, 'bishop': 2, 'books': 4, 'cinema': 2, 'student': 3, 'knight': 1, 'lecture': 2, 'corruption': 3}, {'king': 3, 'bishop': 1, 'exam': 1, 'pawn': 3, 'government': 4, 'TV': 6, 'knight': 3, 'football': 1, 'actor': 2, 'corruption': 4, 'penalty': 2, 'books': 3, 'cinema': 3, 'student': 2, 'president': 1, 'vote': 2, 'lecture': 6, 'goalkeeper': 3}, {'goalkeeper': 2, 'king': 5, 'football': 1, 'exam': 4, 'pawn': 1, 'cinema': 1, 'TV': 3, 'knight': 2, 'government': 2, 'actor': 2, 'corruption': 5, 'penalty': 2, 'books': 2, 'student': 5, 'lecture': 4, 'vote': 1, 'president': 3, 'bishop': 2, 'goal': 3}, {'king': 2, 'football': 3, 'exam': 2, 'pawn': 1, 'cinema': 4, 'TV': 6, 'movie': 4, 'knight': 2, 'government': 5, 'penalty': 3, 'books': 2, 'student': 1, 'president': 2, 'vote': 4, 'lecture': 6, 'goalkeeper': 1, 'goal': 2}, {'king': 4, 'goal': 5, 'pawn': 3, 'government': 2, 'TV': 4, 'movie': 1, 'football': 3, 'actor': 3, 'corruption': 2, 'penalty': 3, 'books': 4, 'student': 1, 'president': 1, 'vote': 4, 'lecture': 5, 'goalkeeper': 5}, {'king': 4, 'goal': 3, 'pawn': 2, 'government': 8, 'TV': 4, 'movie': 2, 'knight': 2, 'football': 5, 'actor': 2, 'bishop': 2, 'cinema': 1, 'student': 2, 'president': 2, 'vote': 3, 'lecture': 5, 'corruption': 1, 'exam': 2}, {'lecture': 1, 'exam': 7, 'pawn': 2, 'government': 2, 'TV': 5, 'movie': 3, 'football': 5, 'actor': 1, 'bishop': 2, 'penalty': 2, 'books': 1, 'student': 4, 'knight': 3, 'vote': 5, 'president': 1, 'goalkeeper': 3, 'goal': 3}, {'goalkeeper': 1, 'king': 1, 'football': 2, 'lecture': 3, 'exam': 2, 'pawn': 1, 'government': 5, 'TV': 2, 'movie': 1, 'cinema': 2, 'actor': 1, 'corruption': 4, 'penalty': 6, 'books': 1, 'student': 4, 'knight': 4, 'vote': 3, 'president': 2, 'bishop': 3, 'goal': 2}, {'king': 1, 'movie': 1, 'goal': 3, 'pawn': 4, 'government': 2, 'TV': 1, 'knight': 3, 'football': 1, 'actor': 5, 'bishop': 2, 'penalty': 3, 'books': 2, 'cinema': 1, 'student': 1, 'president': 3, 'vote': 3, 'lecture': 6, 'corruption': 3, 'exam': 5}, {'king': 3, 'exam': 5, 'pawn': 4, 'government': 3, 'TV': 3, 'movie': 3, 'football': 1, 'actor': 1, 'penalty': 3, 'books': 5, 'student': 1, 'president': 3, 'vote': 2, 'lecture': 5, 'corruption': 4, 'goal': 4}, {'goalkeeper': 2, 'king': 3, 'football': 1, 'exam': 2, 'pawn': 1, 'cinema': 1, 'TV': 5, 'knight': 2, 'government': 4, 'actor': 4, 'bishop': 3, 'penalty': 2, 'books': 3, 'student': 4, 'lecture': 5, 'vote': 5, 'president': 2, 'corruption': 1}, {'king': 2, 'president': 1, 'exam': 5, 'pawn': 1, 'government': 5, 'TV': 1, 'movie': 3, 'football': 1, 'actor': 8, 'corruption': 1, 'penalty': 3, 'books': 1, 'cinema': 2, 'student': 3, 'knight': 5, 'vote': 3, 'lecture': 4, 'bishop': 1}, {'king': 1, 'exam': 4, 'pawn': 4, 'government': 2, 'TV': 6, 'movie': 6, 'football': 2, 'actor': 4, 'goalkeeper': 1, 'penalty': 3, 'books': 2, 'student': 4, 'president': 2, 'lecture': 3, 'corruption': 2, 'goal': 4}, {'king': 5, 'exam': 5, 'pawn': 2, 'government': 3, 'TV': 2, 'movie': 2, 'football': 6, 'actor': 3, 'penalty': 3, 'books': 4, 'cinema': 1, 'student': 3, 'president': 1, 'vote': 2, 'lecture': 3, 'goalkeeper': 3, 'goal': 2}, {'king': 2, 'goal': 3, 'pawn': 5, 'government': 3, 'TV': 7, 'movie': 2, 'football': 3, 'actor': 4, 'goalkeeper': 1, 'penalty': 2, 'books': 1, 'cinema': 1, 'student': 4, 'lecture': 5, 'president': 2, 'corruption': 4, 'exam': 1}, {'king': 4, 'bishop': 2, 'goal': 1, 'pawn': 2, 'government': 2, 'TV': 7, 'movie': 3, 'football': 2, 'actor': 1, 'corruption': 1, 'penalty': 4, 'books': 6, 'student': 1, 'knight': 3, 'vote': 1, 'lecture': 3, 'goalkeeper': 3, 'exam': 4}, {'goalkeeper': 2, 'king': 5, 'goal': 3, 'pawn': 3, 'government': 1, 'TV': 3, 'movie': 2, 'knight': 3, 'football': 4, 'actor': 3, 'corruption': 2, 'penalty': 3, 'books': 2, 'cinema': 2, 'student': 2, 'president': 3, 'vote': 1, 'lecture': 2, 'bishop': 2, 'exam': 2}, {'king': 1, 'exam': 3, 'pawn': 3, 'government': 4, 'TV': 5, 'knight': 1, 'football': 6, 'actor': 4, 'goalkeeper': 1, 'penalty': 2, 'books': 6, 'student': 3, 'president': 1, 'vote': 1, 'lecture': 2, 'bishop': 5, 'goal': 2}, {'king': 2, 'football': 3, 'exam': 4, 'pawn': 6, 'government': 3, 'TV': 3, 'movie': 1, 'cinema': 1, 'actor': 2, 'corruption': 2, 'penalty': 4, 'books': 4, 'student': 6, 'president': 1, 'vote': 1, 'lecture': 3, 'goalkeeper': 4}, {'goalkeeper': 4, 'king': 1, 'exam': 1, 'pawn': 4, 'government': 2, 'TV': 5, 'movie': 4, 'cinema': 2, 'actor': 2, 'bishop': 2, 'penalty': 3, 'books': 2, 'student': 3, 'knight': 4, 'vote': 1, 'lecture': 4, 'corruption': 4, 'goal': 2}, {'king': 6, 'exam': 3, 'pawn': 8, 'government': 1, 'TV': 2, 'movie': 1, 'football': 3, 'actor': 1, 'bishop': 3, 'penalty': 3, 'corruption': 2, 'books': 3, 'student': 4, 'lecture': 2, 'goalkeeper': 5, 'goal': 3}, {'king': 5, 'goal': 3, 'pawn': 3, 'government': 7, 'TV': 2, 'knight': 2, 'football': 4, 'corruption': 3, 'books': 3, 'student': 2, 'vote': 3, 'lecture': 3, 'goalkeeper': 7, 'exam': 3}, {'king': 3, 'exam': 6, 'pawn': 3, 'government': 3, 'TV': 1, 'movie': 3, 'football': 1, 'actor': 5, 'bishop': 5, 'corruption': 2, 'books': 2, 'cinema': 2, 'student': 1, 'president': 2, 'vote': 1, 'lecture': 5, 'goalkeeper': 3, 'goal': 2}, {'king': 2, 'goal': 2, 'pawn': 2, 'cinema': 3, 'TV': 1, 'knight': 4, 'government': 3, 'football': 1, 'actor': 1, 'bishop': 2, 'penalty': 2, 'corruption': 2, 'books': 1, 'student': 3, 'president': 3, 'vote': 5, 'lecture': 3, 'goalkeeper': 2, 'exam': 8}, {'king': 3, 'exam': 4, 'pawn': 6, 'government': 3, 'TV': 3, 'knight': 2, 'football': 3, 'actor': 4, 'goalkeeper': 3, 'penalty': 4, 'books': 2, 'student': 3, 'vote': 1, 'lecture': 3, 'corruption': 3, 'goal': 3}, {'king': 2, 'football': 3, 'exam': 6, 'pawn': 2, 'cinema': 1, 'TV': 1, 'knight': 2, 'government': 4, 'actor': 4, 'bishop': 2, 'penalty': 2, 'corruption': 1, 'books': 2, 'student': 2, 'president': 2, 'vote': 3, 'lecture': 2, 'goalkeeper': 5, 'goal': 4}, {'king': 5, 'exam': 4, 'pawn': 4, 'government': 5, 'TV': 5, 'movie': 4, 'football': 3, 'actor': 1, 'bishop': 2, 'penalty': 3, 'corruption': 1, 'books': 6, 'student': 2, 'vote': 1, 'lecture': 1, 'goalkeeper': 3}, {'king': 1, 'goal': 4, 'pawn': 1, 'cinema': 2, 'TV': 2, 'movie': 4, 'government': 10, 'football': 5, 'actor': 2, 'goalkeeper': 1, 'penalty': 1, 'books': 5, 'student': 2, 'lecture': 1, 'vote': 3, 'president': 2, 'bishop': 3, 'exam': 1}, {'king': 4, 'goal': 5, 'pawn': 2, 'government': 1, 'TV': 2, 'knight': 4, 'football': 3, 'bishop': 5, 'penalty': 3, 'corruption': 1, 'books': 3, 'cinema': 3, 'president': 1, 'vote': 2, 'lecture': 3, 'goalkeeper': 3, 'exam': 5}, {'king': 1, 'goal': 3, 'pawn': 5, 'cinema': 2, 'TV': 2, 'movie': 2, 'government': 2, 'football': 5, 'actor': 6, 'goalkeeper': 4, 'penalty': 1, 'books': 7, 'lecture': 1, 'vote': 1, 'president': 3, 'corruption': 1, 'exam': 4}, {'king': 2, 'goal': 3, 'pawn': 4, 'cinema': 3, 'TV': 6, 'movie': 2, 'government': 2, 'football': 2, 'actor': 5, 'corruption': 3, 'penalty': 1, 'student': 4, 'president': 3, 'vote': 3, 'lecture': 4, 'goalkeeper': 2, 'exam': 1}, {'king': 2, 'goal': 2, 'pawn': 2, 'cinema': 1, 'TV': 2, 'government': 1, 'football': 5, 'actor': 2, 'goalkeeper': 2, 'penalty': 5, 'books': 3, 'student': 4, 'president': 4, 'vote': 2, 'lecture': 8, 'corruption': 5}, {'king': 1, 'exam': 5, 'pawn': 7, 'government': 1, 'TV': 5, 'movie': 2, 'football': 2, 'actor': 2, 'bishop': 2, 'corruption': 2, 'books': 6, 'cinema': 2, 'student': 3, 'lecture': 2, 'president': 1, 'goalkeeper': 5, 'goal': 2}, {'king': 4, 'exam': 3, 'government': 3, 'TV': 5, 'movie': 2, 'knight': 1, 'football': 2, 'actor': 3, 'corruption': 1, 'penalty': 4, 'books': 1, 'student': 5, 'lecture': 2, 'vote': 4, 'president': 1, 'goalkeeper': 8, 'goal': 1}, {'king': 2, 'lecture': 1, 'exam': 3, 'pawn': 3, 'government': 4, 'TV': 1, 'movie': 2, 'football': 3, 'actor': 4, 'penalty': 8, 'books': 3, 'cinema': 1, 'student': 3, 'knight': 1, 'vote': 1, 'president': 2, 'bishop': 5, 'goal': 3}, {'bishop': 1, 'goal': 1, 'pawn': 1, 'cinema': 2, 'TV': 5, 'movie': 2, 'government': 6, 'football': 5, 'actor': 2, 'corruption': 1, 'penalty': 3, 'books': 4, 'knight': 2, 'vote': 3, 'lecture': 4, 'goalkeeper': 4, 'exam': 4}, {'king': 3, 'exam': 2, 'government': 4, 'TV': 1, 'movie': 4, 'knight': 1, 'football': 3, 'actor': 4, 'penalty': 4, 'books': 3, 'cinema': 1, 'student': 6, 'president': 1, 'vote': 6, 'lecture': 5, 'corruption': 1, 'goal': 1}, {'king': 2, 'football': 2, 'exam': 7, 'pawn': 1, 'government': 4, 'TV': 4, 'movie': 6, 'cinema': 2, 'actor': 3, 'goalkeeper': 4, 'penalty': 3, 'corruption': 1, 'books': 2, 'student': 2, 'vote': 2, 'lecture': 2, 'bishop': 1, 'goal': 2}, {'king': 3, 'bishop': 2, 'goal': 3, 'government': 6, 'TV': 1, 'knight': 1, 'football': 3, 'actor': 3, 'goalkeeper': 3, 'penalty': 4, 'books': 1, 'cinema': 2, 'student': 1, 'movie': 1, 'vote': 3, 'president': 2, 'corruption': 2, 'exam': 9}, {'goalkeeper': 2, 'king': 1, 'president': 1, 'football': 3, 'exam': 7, 'pawn': 3, 'government': 6, 'TV': 1, 'movie': 1, 'cinema': 1, 'actor': 4, 'corruption': 3, 'books': 1, 'student': 3, 'knight': 3, 'vote': 3, 'lecture': 1, 'bishop': 1, 'goal': 5}, {'movie': 3, 'bishop': 1, 'exam': 2, 'pawn': 1, 'cinema': 5, 'TV': 4, 'knight': 1, 'government': 4, 'football': 1, 'corruption': 1, 'penalty': 7, 'books': 2, 'student': 6, 'president': 3, 'vote': 2, 'lecture': 2, 'goalkeeper': 3, 'goal': 2}, {'king': 1, 'football': 2, 'exam': 5, 'pawn': 4, 'government': 4, 'TV': 3, 'cinema': 2, 'actor': 4, 'goalkeeper': 5, 'penalty': 1, 'books': 4, 'student': 4, 'vote': 2, 'lecture': 4, 'corruption': 2, 'goal': 3}, {'king': 2, 'football': 1, 'goal': 3, 'pawn': 4, 'cinema': 2, 'TV': 4, 'government': 4, 'actor': 2, 'bishop': 2, 'penalty': 1, 'corruption': 4, 'books': 6, 'student': 2, 'president': 1, 'lecture': 2, 'goalkeeper': 6, 'exam': 4}], [{'king': 1, 'football': 1, 'lecture': 1, 'exam': 1, 'pawn': 5, 'government': 5, 'TV': 5, 'knight': 1, 'cinema': 7, 'actor': 5, 'goalkeeper': 2, 'penalty': 1, 'books': 3, 'student': 2, 'movie': 2, 'president': 3, 'bishop': 3, 'goal': 2}, {'movie': 3, 'exam': 2, 'pawn': 3, 'cinema': 3, 'TV': 4, 'knight': 2, 'government': 1, 'football': 2, 'actor': 4, 'bishop': 1, 'penalty': 3, 'books': 3, 'student': 4, 'lecture': 2, 'vote': 1, 'president': 5, 'corruption': 3, 'goal': 4}, {'goalkeeper': 1, 'football': 2, 'goal': 3, 'government': 3, 'TV': 4, 'knight': 6, 'cinema': 2, 'actor': 2, 'corruption': 4, 'penalty': 2, 'books': 1, 'student': 1, 'president': 5, 'vote': 1, 'lecture': 3, 'movie': 4, 'bishop': 3, 'exam': 3}, {'king': 1, 'football': 2, 'goal': 1, 'government': 7, 'TV': 4, 'movie': 4, 'knight': 2, 'cinema': 6, 'actor': 2, 'bishop': 2, 'penalty': 1, 'student': 2, 'president': 1, 'vote': 2, 'lecture': 7, 'goalkeeper': 5, 'exam': 1}, {'king': 2, 'lecture': 4, 'goal': 2, 'cinema': 4, 'TV': 3, 'knight': 6, 'government': 7, 'actor': 5, 'books': 5, 'movie': 6, 'president': 3, 'goalkeeper': 2, 'exam': 1}, {'king': 4, 'bishop': 1, 'goal': 2, 'pawn': 3, 'government': 7, 'TV': 3, 'knight': 6, 'football': 1, 'actor': 2, 'corruption': 2, 'penalty': 3, 'lecture': 1, 'books': 3, 'cinema': 2, 'student': 1, 'movie': 3, 'president': 1, 'goalkeeper': 4, 'exam': 1}, {'king': 2, 'exam': 2, 'pawn': 4, 'government': 4, 'TV': 7, 'movie': 3, 'football': 2, 'actor': 2, 'corruption': 1, 'penalty': 1, 'books': 2, 'cinema': 1, 'student': 5, 'lecture': 5, 'vote': 1, 'president': 2, 'goalkeeper': 3, 'goal': 3}, {'king': 2, 'president': 3, 'football': 1, 'pawn': 2, 'government': 2, 'TV': 1, 'movie': 5, 'cinema': 2, 'actor': 1, 'bishop': 2, 'penalty': 2, 'books': 9, 'student': 1, 'knight': 5, 'lecture': 4, 'goalkeeper': 8}, {'king': 3, 'president': 3, 'goal': 5, 'pawn': 3, 'cinema': 1, 'bishop': 2, 'movie': 3, 'football': 1, 'actor': 2, 'corruption': 2, 'penalty': 6, 'TV': 1, 'books': 2, 'student': 5, 'knight': 3, 'vote': 2, 'lecture': 3, 'goalkeeper': 3}, {'king': 1, 'football': 2, 'bishop': 2, 'goal': 2, 'pawn': 2, 'government': 4, 'TV': 4, 'movie': 2, 'cinema': 3, 'actor': 5, 'goalkeeper': 3, 'penalty': 2, 'books': 1, 'student': 6, 'lecture': 5, 'president': 5, 'corruption': 1}, {'football': 1, 'bishop': 1, 'exam': 5, 'pawn': 1, 'cinema': 6, 'TV': 2, 'knight': 3, 'government': 5, 'actor': 1, 'corruption': 3, 'books': 4, 'student': 1, 'president': 2, 'vote': 2, 'lecture': 3, 'movie': 4, 'goalkeeper': 5, 'goal': 1}, {'king': 1, 'football': 1, 'exam': 7, 'government': 6, 'TV': 4, 'movie': 6, 'knight': 1, 'cinema': 6, 'actor': 2, 'corruption': 1, 'penalty': 1, 'books': 2, 'lecture': 2, 'vote': 1, 'president': 5, 'goalkeeper': 3, 'goal': 1}, {'exam': 3, 'cinema': 2, 'TV': 6, 'movie': 4, 'government': 3, 'football': 1, 'goalkeeper': 7, 'penalty': 2, 'books': 6, 'lecture': 6, 'president': 4, 'corruption': 3, 'goal': 3}, {'goalkeeper': 2, 'king': 1, 'lecture': 2, 'goal': 1, 'pawn': 2, 'cinema': 4, 'TV': 3, 'movie': 12, 'government': 5, 'actor': 2, 'bishop': 3, 'books': 2, 'student': 1, 'knight': 3, 'vote': 2, 'president': 2, 'corruption': 3}, {'football': 2, 'lecture': 3, 'exam': 2, 'pawn': 1, 'cinema': 5, 'TV': 6, 'movie': 5, 'government': 2, 'actor': 1, 'bishop': 1, 'corruption': 1, 'books': 8, 'knight': 1, 'president': 8, 'goalkeeper': 3, 'goal': 1}, {'president': 1, 'goal': 4, 'pawn': 5, 'cinema': 4, 'TV': 5, 'movie': 2, 'government': 2, 'football': 1, 'actor': 2, 'penalty': 4, 'books': 3, 'student': 4, 'knight': 4, 'vote': 1, 'lecture': 3, 'goalkeeper': 5}, {'king': 3, 'lecture': 3, 'exam': 1, 'pawn': 2, 'cinema': 5, 'TV': 3, 'movie': 2, 'government': 4, 'football': 2, 'actor': 3, 'goalkeeper': 4, 'penalty': 3, 'books': 1, 'student': 1, 'knight': 2, 'president': 5, 'corruption': 4, 'goal': 2}, {'king': 2, 'football': 1, 'exam': 2, 'pawn': 2, 'cinema': 10, 'movie': 3, 'knight': 1, 'government': 3, 'goalkeeper': 2, 'penalty': 2, 'corruption': 1, 'books': 3, 'lecture': 3, 'vote': 1, 'president': 7, 'bishop': 6, 'goal': 1}, {'goalkeeper': 3, 'king': 2, 'president': 1, 'goal': 1, 'pawn': 1, 'government': 6, 'TV': 2, 'movie': 4, 'football': 1, 'actor': 3, 'bishop': 3, 'books': 5, 'cinema': 2, 'student': 4, 'knight': 3, 'lecture': 5, 'corruption': 2, 'exam': 2}, {'lecture': 7, 'exam': 2, 'government': 3, 'TV': 4, 'movie': 6, 'football': 3, 'actor': 1, 'bishop': 2, 'penalty': 3, 'books': 2, 'cinema': 7, 'knight': 4, 'president': 2, 'corruption': 1, 'goal': 3}, {'king': 1, 'football': 3, 'goal': 4, 'pawn': 3, 'government': 4, 'TV': 3, 'knight': 3, 'cinema': 1, 'actor': 3, 'goalkeeper': 5, 'penalty': 3, 'corruption': 1, 'books': 2, 'student': 4, 'movie': 4, 'lecture': 2, 'bishop': 3, 'exam': 1}, {'king': 1, 'president': 3, 'goal': 4, 'pawn': 3, 'government': 6, 'TV': 3, 'movie': 1, 'cinema': 3, 'actor': 2, 'goalkeeper': 3, 'penalty': 4, 'corruption': 1, 'books': 5, 'student': 1, 'knight': 5, 'lecture': 4, 'bishop': 1}, {'king': 2, 'president': 1, 'exam': 2, 'government': 7, 'TV': 3, 'knight': 1, 'cinema': 4, 'actor': 2, 'corruption': 7, 'penalty': 3, 'books': 5, 'movie': 2, 'vote': 2, 'lecture': 3, 'bishop': 3, 'goal': 3}, {'movie': 3, 'exam': 3, 'pawn': 4, 'cinema': 4, 'bishop': 3, 'knight': 2, 'government': 8, 'actor': 3, 'corruption': 2, 'penalty': 3, 'TV': 3, 'books': 2, 'president': 2, 'vote': 1, 'lecture': 4, 'goalkeeper': 1, 'goal': 2}, {'king': 2, 'bishop': 4, 'exam': 4, 'pawn': 1, 'government': 4, 'TV': 2, 'movie': 8, 'knight': 2, 'football': 1, 'corruption': 2, 'books': 3, 'student': 1, 'lecture': 7, 'vote': 1, 'president': 4, 'goalkeeper': 3, 'goal': 1}, {'king': 1, 'lecture': 6, 'goal': 2, 'cinema': 5, 'TV': 3, 'knight': 2, 'government': 3, 'bishop': 2, 'penalty': 2, 'corruption': 2, 'books': 6, 'movie': 4, 'vote': 1, 'president': 5, 'goalkeeper': 4, 'exam': 2}, {'pawn': 6, 'cinema': 6, 'TV': 5, 'knight': 5, 'government': 4, 'actor': 6, 'goalkeeper': 1, 'penalty': 5, 'books': 1, 'president': 3, 'vote': 1, 'lecture': 4, 'corruption': 3}, {'king': 3, 'movie': 1, 'exam': 2, 'pawn': 4, 'cinema': 4, 'bishop': 1, 'knight': 3, 'government': 3, 'football': 5, 'actor': 6, 'corruption': 1, 'penalty': 1, 'TV': 2, 'books': 4, 'student': 1, 'president': 2, 'lecture': 5, 'goalkeeper': 1, 'goal': 1}, {'king': 2, 'movie': 1, 'bishop': 3, 'exam': 1, 'pawn': 4, 'government': 3, 'TV': 8, 'knight': 3, 'cinema': 6, 'actor': 3, 'goalkeeper': 1, 'penalty': 1, 'books': 1, 'student': 2, 'president': 3, 'lecture': 5, 'corruption': 2, 'goal': 1}, {'king': 1, 'exam': 1, 'pawn': 3, 'cinema': 6, 'TV': 3, 'movie': 3, 'knight': 2, 'government': 2, 'actor': 1, 'goalkeeper': 4, 'penalty': 2, 'corruption': 3, 'books': 1, 'student': 1, 'lecture': 7, 'president': 5, 'bishop': 3, 'goal': 2}, {'king': 2, 'exam': 2, 'pawn': 1, 'government': 3, 'bishop': 1, 'knight': 5, 'football': 2, 'actor': 3, 'goalkeeper': 1, 'penalty': 2, 'books': 4, 'student': 5, 'movie': 3, 'vote': 1, 'president': 7, 'corruption': 4, 'goal': 4}, {'lecture': 4, 'exam': 3, 'pawn': 2, 'government': 6, 'TV': 6, 'knight': 1, 'cinema': 6, 'actor': 2, 'corruption': 1, 'books': 3, 'movie': 7, 'president': 5, 'goalkeeper': 4}, {'lecture': 3, 'exam': 1, 'pawn': 6, 'cinema': 4, 'TV': 2, 'movie': 3, 'government': 3, 'football': 1, 'actor': 1, 'goalkeeper': 6, 'penalty': 2, 'corruption': 1, 'books': 3, 'student': 3, 'knight': 4, 'president': 4, 'bishop': 3}, {'king': 2, 'president': 3, 'football': 4, 'goal': 1, 'pawn': 4, 'government': 2, 'TV': 5, 'knight': 3, 'cinema': 1, 'actor': 1, 'bishop': 3, 'penalty': 1, 'corruption': 4, 'books': 2, 'student': 2, 'movie': 1, 'vote': 3, 'lecture': 4, 'goalkeeper': 4}, {'king': 4, 'goal': 3, 'pawn': 4, 'government': 5, 'TV': 2, 'movie': 3, 'knight': 1, 'cinema': 2, 'actor': 2, 'goalkeeper': 5, 'penalty': 4, 'books': 2, 'student': 3, 'lecture': 1, 'vote': 3, 'president': 4, 'bishop': 1, 'exam': 1}, {'goalkeeper': 1, 'movie': 8, 'goal': 1, 'pawn': 2, 'government': 5, 'TV': 4, 'knight': 2, 'cinema': 5, 'bishop': 4, 'books': 1, 'student': 1, 'lecture': 5, 'vote': 1, 'president': 5, 'corruption': 2, 'exam': 3}, {'king': 3, 'movie': 1, 'bishop': 1, 'exam': 2, 'pawn': 2, 'cinema': 4, 'TV': 3, 'knight': 2, 'government': 9, 'actor': 1, 'corruption': 1, 'penalty': 3, 'books': 6, 'student': 4, 'lecture': 1, 'vote': 1, 'president': 2, 'goalkeeper': 4}, {'football': 1, 'exam': 4, 'pawn': 1, 'government': 5, 'TV': 2, 'movie': 1, 'knight': 2, 'cinema': 7, 'actor': 2, 'goalkeeper': 4, 'corruption': 1, 'books': 2, 'student': 2, 'president': 3, 'vote': 3, 'lecture': 3, 'bishop': 3, 'goal': 4}, {'king': 1, 'lecture': 1, 'goal': 5, 'pawn': 3, 'cinema': 6, 'TV': 3, 'knight': 3, 'government': 4, 'football': 2, 'actor': 1, 'goalkeeper': 4, 'penalty': 1, 'corruption': 2, 'books': 3, 'student': 2, 'movie': 1, 'president': 2, 'bishop': 6}, {'king': 1, 'president': 1, 'goal': 4, 'pawn': 3, 'cinema': 4, 'TV': 9, 'knight': 1, 'government': 3, 'actor': 2, 'bishop': 1, 'corruption': 3, 'books': 3, 'student': 1, 'movie': 2, 'vote': 4, 'lecture': 1, 'goalkeeper': 6, 'exam': 1}, {'king': 2, 'movie': 2, 'exam': 4, 'pawn': 2, 'cinema': 6, 'TV': 2, 'knight': 2, 'government': 3, 'actor': 2, 'goalkeeper': 4, 'penalty': 1, 'corruption': 4, 'books': 2, 'student': 4, 'lecture': 3, 'president': 3, 'bishop': 4}, {'exam': 3, 'pawn': 2, 'cinema': 4, 'TV': 6, 'movie': 7, 'government': 3, 'football': 3, 'actor': 3, 'goalkeeper': 2, 'books': 8, 'student': 3, 'president': 1, 'vote': 2, 'lecture': 1, 'corruption': 1, 'goal': 1}, {'king': 2, 'lecture': 3, 'goal': 2, 'pawn': 1, 'cinema': 6, 'TV': 3, 'movie': 12, 'football': 1, 'goalkeeper': 3, 'penalty': 2, 'corruption': 1, 'books': 4, 'student': 1, 'knight': 1, 'president': 3, 'bishop': 3, 'exam': 2}, {'king': 1, 'exam': 3, 'pawn': 2, 'cinema': 7, 'movie': 4, 'knight': 2, 'football': 3, 'bishop': 1, 'penalty': 1, 'books': 1, 'student': 3, 'president': 9, 'lecture': 3, 'government': 3, 'corruption': 2, 'goal': 5}, {'king': 1, 'football': 1, 'bishop': 1, 'exam': 2, 'pawn': 2, 'government': 3, 'TV': 6, 'knight': 2, 'cinema': 1, 'actor': 1, 'goalkeeper': 5, 'penalty': 1, 'books': 2, 'student': 6, 'president': 3, 'vote': 1, 'lecture': 5, 'corruption': 4, 'goal': 3}, {'lecture': 1, 'goal': 2, 'pawn': 3, 'government': 4, 'TV': 3, 'movie': 4, 'cinema': 7, 'actor': 4, 'corruption': 2, 'books': 3, 'student': 4, 'knight': 3, 'vote': 1, 'president': 3, 'goalkeeper': 5, 'bishop': 1}, {'goal': 1, 'cinema': 7, 'movie': 6, 'knight': 3, 'government': 5, 'actor': 2, 'goalkeeper': 1, 'books': 6, 'lecture': 6, 'president': 6, 'bishop': 7}, {'movie': 2, 'goal': 4, 'pawn': 1, 'government': 2, 'knight': 3, 'football': 1, 'actor': 4, 'bishop': 3, 'penalty': 2, 'corruption': 3, 'books': 3, 'cinema': 1, 'student': 2, 'president': 5, 'vote': 4, 'lecture': 1, 'goalkeeper': 6, 'exam': 3}, {'movie': 4, 'exam': 1, 'cinema': 4, 'TV': 1, 'knight': 1, 'government': 7, 'actor': 4, 'goalkeeper': 3, 'penalty': 1, 'corruption': 3, 'books': 3, 'student': 1, 'president': 5, 'vote': 2, 'lecture': 7, 'bishop': 3}, {'movie': 3, 'exam': 3, 'cinema': 4, 'TV': 1, 'knight': 3, 'government': 7, 'football': 1, 'goalkeeper': 1, 'penalty': 1, 'books': 2, 'actor': 1, 'lecture': 7, 'vote': 1, 'president': 5, 'bishop': 9, 'goal': 1}], [{'king': 1, 'football': 1, 'bishop': 3, 'exam': 5, 'pawn': 2, 'government': 2, 'TV': 2, 'movie': 4, 'cinema': 4, 'actor': 1, 'corruption': 4, 'penalty': 3, 'books': 1, 'student': 1, 'knight': 1, 'vote': 3, 'lecture': 6, 'goalkeeper': 5, 'goal': 1}, {'king': 1, 'exam': 1, 'pawn': 2, 'cinema': 4, 'TV': 2, 'movie': 8, 'knight': 4, 'government': 2, 'actor': 1, 'goalkeeper': 3, 'books': 4, 'student': 2, 'lecture': 5, 'vote': 1, 'president': 4, 'bishop': 3, 'goal': 3}, {'lecture': 6, 'exam': 2, 'cinema': 9, 'TV': 1, 'movie': 6, 'government': 2, 'actor': 2, 'bishop': 4, 'corruption': 1, 'books': 1, 'knight': 4, 'president': 6, 'goalkeeper': 5, 'goal': 1}, {'goalkeeper': 3, 'football': 1, 'lecture': 6, 'exam': 3, 'government': 5, 'TV': 1, 'knight': 2, 'cinema': 5, 'actor': 1, 'bishop': 7, 'penalty': 1, 'books': 4, 'student': 2, 'movie': 4, 'president': 3, 'corruption': 1, 'goal': 1}, {'movie': 3, 'exam': 5, 'government': 4, 'bishop': 3, 'knight': 4, 'cinema': 5, 'corruption': 2, 'penalty': 1, 'books': 3, 'president': 4, 'vote': 2, 'lecture': 5, 'goalkeeper': 5, 'goal': 4}, {'king': 3, 'lecture': 4, 'exam': 2, 'pawn': 2, 'cinema': 3, 'TV': 4, 'knight': 4, 'government': 3, 'football': 2, 'actor': 2, 'penalty': 3, 'books': 4, 'student': 5, 'movie': 4, 'president': 2, 'goalkeeper': 1, 'goal': 2}, {'king': 2, 'president': 2, 'bishop': 3, 'goal': 4, 'pawn': 3, 'government': 1, 'TV': 2, 'movie': 4, 'football': 4, 'actor': 3, 'goalkeeper': 2, 'penalty': 1, 'books': 5, 'cinema': 3, 'student': 1, 'knight': 1, 'vote': 3, 'lecture': 3, 'corruption': 2, 'exam': 1}, {'king': 2, 'president': 2, 'exam': 3, 'pawn': 2, 'cinema': 3, 'TV': 1, 'knight': 8, 'government': 6, 'actor': 1, 'goalkeeper': 3, 'penalty': 1, 'student': 3, 'movie': 4, 'vote': 2, 'lecture': 5, 'bishop': 4}, {'king': 1, 'president': 5, 'bishop': 3, 'exam': 2, 'cinema': 5, 'TV': 4, 'movie': 4, 'government': 4, 'actor': 2, 'corruption': 4, 'penalty': 2, 'books': 3, 'student': 2, 'knight': 2, 'vote': 1, 'lecture': 3, 'goalkeeper': 1, 'goal': 2}, {'king': 1, 'president': 1, 'football': 1, 'goal': 3, 'government': 3, 'knight': 5, 'cinema': 7, 'actor': 2, 'bishop': 3, 'penalty': 2, 'corruption': 1, 'books': 3, 'movie': 7, 'vote': 2, 'lecture': 6, 'goalkeeper': 2, 'exam': 1}, {'king': 1, 'movie': 2, 'exam': 5, 'government': 4, 'TV': 3, 'knight': 4, 'football': 1, 'actor': 2, 'goalkeeper': 3, 'penalty': 4, 'corruption': 1, 'books': 5, 'cinema': 1, 'student': 1, 'lecture': 3, 'vote': 3, 'president': 4, 'bishop': 2, 'goal': 1}, {'king': 1, 'lecture': 2, 'exam': 2, 'government': 7, 'TV': 1, 'movie': 6, 'cinema': 2, 'actor': 3, 'bishop': 3, 'penalty': 2, 'books': 6, 'student': 2, 'knight': 4, 'president': 4, 'corruption': 3, 'goal': 2}, {'king': 3, 'football': 1, 'exam': 5, 'pawn': 1, 'government': 4, 'bishop': 4, 'movie': 1, 'knight': 1, 'cinema': 2, 'actor': 7, 'goalkeeper': 3, 'books': 3, 'student': 1, 'lecture': 5, 'vote': 3, 'president': 4, 'corruption': 1, 'goal': 1}, {'football': 2, 'king': 1, 'movie': 5, 'bishop': 1, 'goal': 2, 'pawn': 1, 'government': 2, 'TV': 2, 'knight': 5, 'cinema': 6, 'actor': 2, 'goalkeeper': 1, 'penalty': 3, 'books': 2, 'student': 4, 'lecture': 2, 'vote': 2, 'president': 4, 'corruption': 2, 'exam': 1}, {'football': 3, 'goal': 5, 'pawn': 2, 'cinema': 3, 'TV': 3, 'knight': 3, 'government': 3, 'actor': 1, 'bishop': 3, 'penalty': 1, 'corruption': 2, 'books': 2, 'student': 3, 'president': 4, 'vote': 2, 'lecture': 5, 'movie': 1, 'goalkeeper': 4}, {'king': 1, 'movie': 7, 'exam': 3, 'pawn': 1, 'cinema': 10, 'TV': 1, 'knight': 3, 'government': 5, 'actor': 2, 'goalkeeper': 1, 'penalty': 1, 'books': 2, 'student': 1, 'president': 1, 'lecture': 5, 'bishop': 3, 'goal': 3}, {'king': 2, 'goal': 6, 'cinema': 6, 'TV': 4, 'knight': 1, 'government': 1, 'football': 1, 'actor': 1, 'bishop': 4, 'penalty': 2, 'books': 2, 'student': 1, 'lecture': 3, 'vote': 2, 'president': 7, 'goalkeeper': 2, 'exam': 5}, {'king': 3, 'goal': 4, 'pawn': 2, 'cinema': 3, 'TV': 2, 'knight': 2, 'government': 5, 'actor': 1, 'bishop': 2, 'penalty': 1, 'corruption': 1, 'books': 5, 'student': 1, 'president': 4, 'vote': 4, 'lecture': 3, 'goalkeeper': 3, 'exam': 4}, {'football': 3, 'exam': 3, 'pawn': 2, 'cinema': 4, 'TV': 2, 'movie': 6, 'knight': 2, 'government': 8, 'bishop': 3, 'books': 7, 'student': 1, 'president': 1, 'vote': 2, 'lecture': 4, 'goalkeeper': 2}, {'king': 1, 'president': 4, 'exam': 1, 'cinema': 7, 'knight': 4, 'government': 6, 'actor': 1, 'goalkeeper': 2, 'books': 3, 'movie': 4, 'vote': 2, 'lecture': 7, 'bishop': 5, 'goal': 3}, {'king': 3, 'exam': 5, 'government': 3, 'TV': 1, 'movie': 3, 'knight': 2, 'football': 1, 'actor': 3, 'bishop': 3, 'penalty': 3, 'corruption': 1, 'books': 2, 'cinema': 2, 'student': 1, 'president': 3, 'vote': 3, 'lecture': 7, 'goalkeeper': 4}, {'goalkeeper': 2, 'king': 2, 'president': 2, 'goal': 3, 'government': 2, 'TV': 1, 'knight': 5, 'football': 4, 'actor': 1, 'bishop': 2, 'penalty': 8, 'books': 1, 'student': 3, 'movie': 2, 'vote': 6, 'lecture': 4, 'corruption': 1, 'exam': 1}, {'king': 2, 'football': 2, 'lecture': 1, 'exam': 4, 'cinema': 6, 'TV': 3, 'knight': 4, 'government': 4, 'actor': 4, 'bishop': 3, 'penalty': 2, 'books': 2, 'student': 4, 'movie': 2, 'vote': 4, 'president': 1, 'goalkeeper': 1, 'goal': 1}, {'goalkeeper': 3, 'king': 7, 'football': 4, 'exam': 2, 'pawn': 2, 'cinema': 2, 'TV': 2, 'knight': 3, 'government': 3, 'actor': 1, 'corruption': 3, 'penalty': 4, 'books': 1, 'student': 1, 'president': 1, 'vote': 4, 'lecture': 3, 'movie': 1, 'bishop': 2, 'goal': 1}, {'king': 2, 'lecture': 6, 'goal': 5, 'pawn': 1, 'government': 4, 'TV': 6, 'movie': 3, 'cinema': 3, 'actor': 3, 'goalkeeper': 1, 'penalty': 1, 'books': 1, 'student': 2, 'knight': 4, 'vote': 1, 'president': 4, 'corruption': 2, 'exam': 1}, {'king': 1, 'football': 1, 'lecture': 5, 'exam': 4, 'government': 6, 'TV': 6, 'knight': 3, 'cinema': 4, 'actor': 2, 'bishop': 1, 'books': 2, 'student': 2, 'movie': 4, 'vote': 1, 'president': 4, 'goalkeeper': 2, 'goal': 2}, {'goalkeeper': 1, 'king': 1, 'president': 1, 'goal': 3, 'government': 5, 'TV': 1, 'movie': 6, 'cinema': 4, 'actor': 4, 'corruption': 3, 'penalty': 2, 'books': 2, 'student': 1, 'knight': 2, 'vote': 2, 'lecture': 3, 'bishop': 4, 'exam': 5}, {'king': 2, 'football': 1, 'goal': 2, 'pawn': 1, 'cinema': 3, 'TV': 4, 'knight': 1, 'government': 4, 'actor': 3, 'goalkeeper': 1, 'penalty': 4, 'corruption': 1, 'books': 2, 'student': 1, 'lecture': 5, 'vote': 2, 'president': 5, 'movie': 1, 'bishop': 5, 'exam': 2}, {'goalkeeper': 2, 'president': 4, 'goal': 1, 'government': 5, 'TV': 3, 'knight': 3, 'cinema': 3, 'actor': 3, 'bishop': 3, 'penalty': 2, 'books': 3, 'movie': 8, 'vote': 2, 'lecture': 5, 'corruption': 2, 'exam': 1}, {'goalkeeper': 1, 'king': 4, 'lecture': 3, 'exam': 4, 'government': 3, 'TV': 1, 'knight': 6, 'football': 4, 'actor': 1, 'corruption': 2, 'penalty': 3, 'cinema': 3, 'student': 3, 'movie': 1, 'vote': 2, 'president': 2, 'bishop': 2, 'goal': 5}, {'king': 3, 'movie': 1, 'exam': 3, 'pawn': 1, 'cinema': 5, 'TV': 1, 'knight': 4, 'government': 1, 'football': 4, 'actor': 4, 'corruption': 4, 'penalty': 3, 'president': 2, 'vote': 3, 'lecture': 8, 'bishop': 2, 'goal': 1}, {'goalkeeper': 3, 'movie': 1, 'exam': 5, 'government': 8, 'knight': 1, 'football': 3, 'actor': 1, 'corruption': 2, 'penalty': 3, 'books': 2, 'cinema': 2, 'student': 2, 'lecture': 4, 'vote': 3, 'president': 4, 'bishop': 4, 'goal': 2}, {'king': 2, 'football': 1, 'exam': 3, 'pawn': 1, 'government': 8, 'TV': 2, 'knight': 3, 'cinema': 2, 'actor': 2, 'bishop': 2, 'penalty': 3, 'books': 5, 'student': 3, 'president': 3, 'vote': 2, 'lecture': 3, 'movie': 1, 'corruption': 3, 'goal': 1}, {'king': 1, 'movie': 3, 'exam': 4, 'pawn': 1, 'government': 5, 'knight': 6, 'football': 3, 'actor': 2, 'corruption': 2, 'penalty': 2, 'books': 3, 'student': 2, 'president': 3, 'vote': 3, 'lecture': 4, 'goalkeeper': 4, 'goal': 2}, {'king': 3, 'football': 2, 'goal': 1, 'pawn': 2, 'government': 5, 'bishop': 1, 'knight': 3, 'cinema': 1, 'actor': 3, 'goalkeeper': 1, 'penalty': 4, 'books': 3, 'student': 2, 'lecture': 4, 'vote': 3, 'president': 8, 'corruption': 1, 'exam': 3}, {'king': 1, 'president': 3, 'football': 3, 'exam': 1, 'pawn': 2, 'government': 5, 'TV': 1, 'knight': 3, 'cinema': 3, 'actor': 1, 'bishop': 1, 'penalty': 3, 'corruption': 1, 'books': 4, 'student': 3, 'movie': 4, 'vote': 1, 'lecture': 3, 'goalkeeper': 2, 'goal': 5}, {'goalkeeper': 5, 'king': 1, 'football': 1, 'goal': 3, 'pawn': 1, 'cinema': 5, 'TV': 1, 'movie': 2, 'knight': 2, 'government': 4, 'actor': 4, 'corruption': 2, 'penalty': 2, 'books': 1, 'student': 1, 'president': 5, 'vote': 2, 'lecture': 3, 'bishop': 3, 'exam': 2}, {'king': 4, 'movie': 1, 'exam': 3, 'pawn': 1, 'government': 7, 'knight': 3, 'football': 2, 'actor': 1, 'goalkeeper': 3, 'penalty': 5, 'cinema': 1, 'student': 3, 'lecture': 7, 'vote': 2, 'president': 5, 'corruption': 1, 'goal': 1}, {'football': 1, 'king': 1, 'movie': 3, 'exam': 3, 'pawn': 4, 'cinema': 2, 'TV': 7, 'knight': 2, 'government': 2, 'actor': 1, 'goalkeeper': 5, 'penalty': 3, 'books': 5, 'student': 1, 'president': 4, 'lecture': 3, 'bishop': 2, 'goal': 1}, {'goalkeeper': 1, 'king': 7, 'exam': 3, 'government': 8, 'TV': 2, 'knight': 4, 'football': 3, 'actor': 2, 'corruption': 2, 'penalty': 3, 'books': 2, 'cinema': 2, 'student': 3, 'movie': 1, 'vote': 1, 'lecture': 2, 'bishop': 2, 'goal': 2}, {'king': 2, 'goal': 6, 'pawn': 2, 'cinema': 4, 'TV': 1, 'knight': 2, 'government': 3, 'football': 2, 'actor': 2, 'corruption': 4, 'penalty': 2, 'books': 4, 'student': 3, 'lecture': 1, 'vote': 1, 'president': 4, 'goalkeeper': 5, 'exam': 2}, {'goalkeeper': 1, 'king': 5, 'movie': 1, 'exam': 5, 'government': 6, 'TV': 3, 'knight': 6, 'football': 3, 'bishop': 2, 'penalty': 3, 'books': 1, 'cinema': 1, 'student': 2, 'lecture': 5, 'vote': 1, 'president': 2, 'corruption': 2, 'goal': 1}, {'king': 4, 'exam': 5, 'pawn': 1, 'government': 4, 'TV': 2, 'knight': 3, 'football': 4, 'actor': 1, 'corruption': 4, 'penalty': 2, 'books': 2, 'cinema': 4, 'student': 3, 'lecture': 3, 'vote': 4, 'president': 2, 'bishop': 2}, {'goalkeeper': 2, 'king': 2, 'exam': 3, 'pawn': 2, 'cinema': 5, 'TV': 1, 'movie': 2, 'government': 3, 'football': 2, 'actor': 2, 'bishop': 1, 'penalty': 2, 'books': 5, 'student': 3, 'lecture': 3, 'vote': 3, 'president': 7, 'corruption': 1, 'goal': 1}, {'king': 2, 'bishop': 1, 'goal': 1, 'pawn': 2, 'government': 2, 'TV': 3, 'movie': 1, 'football': 3, 'actor': 2, 'corruption': 5, 'penalty': 4, 'books': 3, 'cinema': 1, 'student': 3, 'knight': 3, 'vote': 6, 'lecture': 2, 'goalkeeper': 3, 'exam': 3}, {'king': 3, 'president': 1, 'exam': 3, 'government': 7, 'TV': 2, 'movie': 6, 'football': 5, 'actor': 1, 'corruption': 1, 'penalty': 2, 'books': 2, 'cinema': 4, 'student': 3, 'knight': 1, 'vote': 2, 'lecture': 3, 'bishop': 3, 'goal': 1}, {'king': 3, 'exam': 3, 'cinema': 3, 'TV': 2, 'movie': 3, 'government': 6, 'football': 1, 'actor': 2, 'bishop': 3, 'penalty': 2, 'books': 5, 'student': 2, 'knight': 3, 'vote': 5, 'lecture': 3, 'corruption': 2, 'goal': 2}, {'king': 2, 'goal': 2, 'cinema': 4, 'bishop': 3, 'knight': 3, 'government': 5, 'football': 1, 'actor': 1, 'goalkeeper': 4, 'books': 7, 'student': 2, 'movie': 4, 'vote': 1, 'president': 6, 'corruption': 2, 'exam': 3}, {'king': 4, 'president': 1, 'exam': 1, 'pawn': 3, 'government': 6, 'TV': 2, 'knight': 5, 'cinema': 7, 'actor': 6, 'bishop': 2, 'penalty': 3, 'corruption': 2, 'movie': 1, 'lecture': 1, 'goalkeeper': 5, 'goal': 1}, {'king': 2, 'football': 1, 'bishop': 3, 'exam': 3, 'pawn': 1, 'government': 4, 'TV': 3, 'knight': 2, 'cinema': 4, 'actor': 2, 'movie': 3, 'penalty': 1, 'corruption': 1, 'books': 5, 'student': 2, 'lecture': 7, 'vote': 1, 'president': 2, 'goalkeeper': 2, 'goal': 1}], [{'king': 1, 'football': 3, 'bishop': 1, 'exam': 2, 'cinema': 3, 'TV': 1, 'knight': 4, 'government': 4, 'actor': 2, 'corruption': 3, 'penalty': 2, 'books': 4, 'student': 4, 'president': 1, 'vote': 5, 'lecture': 6, 'goalkeeper': 4}, {'king': 1, 'president': 1, 'goal': 4, 'pawn': 3, 'government': 6, 'TV': 5, 'movie': 5, 'football': 1, 'actor': 1, 'goalkeeper': 3, 'penalty': 1, 'books': 2, 'cinema': 1, 'student': 1, 'knight': 2, 'vote': 2, 'lecture': 6, 'bishop': 2, 'exam': 3}, {'king': 3, 'bishop': 2, 'exam': 2, 'pawn': 1, 'government': 3, 'TV': 3, 'movie': 3, 'knight': 2, 'football': 4, 'actor': 3, 'corruption': 1, 'penalty': 5, 'books': 2, 'cinema': 3, 'student': 2, 'president': 2, 'vote': 2, 'lecture': 5, 'goalkeeper': 1, 'goal': 1}, {'movie': 5, 'goal': 2, 'government': 8, 'TV': 3, 'knight': 1, 'cinema': 5, 'football': 2, 'goalkeeper': 4, 'penalty': 2, 'corruption': 1, 'books': 6, 'student': 1, 'president': 4, 'vote': 1, 'lecture': 1, 'bishop': 2, 'exam': 2}, {'king': 1, 'exam': 6, 'pawn': 1, 'government': 7, 'TV': 3, 'knight': 1, 'football': 4, 'actor': 3, 'bishop': 3, 'corruption': 2, 'books': 4, 'cinema': 2, 'student': 4, 'movie': 2, 'vote': 2, 'president': 1, 'goalkeeper': 4}, {'goalkeeper': 2, 'king': 1, 'exam': 9, 'pawn': 4, 'government': 5, 'knight': 2, 'cinema': 2, 'actor': 5, 'corruption': 2, 'penalty': 4, 'books': 2, 'movie': 1, 'vote': 2, 'lecture': 6, 'bishop': 3}, {'goalkeeper': 4, 'king': 2, 'president': 1, 'exam': 2, 'pawn': 4, 'cinema': 3, 'TV': 1, 'movie': 4, 'government': 6, 'actor': 1, 'bishop': 3, 'penalty': 1, 'books': 3, 'student': 1, 'knight': 3, 'vote': 5, 'lecture': 3, 'corruption': 1, 'goal': 2}, {'king': 2, 'exam': 6, 'pawn': 1, 'government': 3, 'TV': 4, 'movie': 2, 'knight': 2, 'football': 3, 'bishop': 2, 'penalty': 3, 'corruption': 3, 'books': 4, 'cinema': 4, 'student': 1, 'president': 2, 'vote': 4, 'lecture': 1, 'goalkeeper': 2, 'goal': 1}, {'goalkeeper': 2, 'president': 2, 'exam': 3, 'pawn': 1, 'government': 7, 'movie': 6, 'football': 1, 'corruption': 3, 'penalty': 2, 'books': 1, 'cinema': 5, 'student': 2, 'knight': 4, 'vote': 2, 'lecture': 4, 'bishop': 4, 'goal': 1}, {'goalkeeper': 1, 'king': 2, 'exam': 4, 'pawn': 1, 'cinema': 4, 'TV': 1, 'movie': 7, 'government': 3, 'football': 3, 'actor': 1, 'corruption': 3, 'books': 4, 'lecture': 6, 'vote': 1, 'president': 4, 'knight': 2, 'bishop': 3}, {'movie': 4, 'exam': 4, 'pawn': 1, 'cinema': 4, 'TV': 3, 'knight': 4, 'government': 5, 'actor': 1, 'goalkeeper': 3, 'penalty': 1, 'corruption': 1, 'books': 3, 'lecture': 2, 'vote': 3, 'president': 5, 'bishop': 4, 'goal': 2}, {'football': 1, 'king': 2, 'movie': 1, 'exam': 7, 'pawn': 1, 'government': 5, 'TV': 2, 'knight': 7, 'cinema': 2, 'actor': 1, 'goalkeeper': 3, 'penalty': 3, 'corruption': 2, 'books': 2, 'student': 1, 'president': 4, 'vote': 2, 'lecture': 1, 'bishop': 2, 'goal': 1}, {'goalkeeper': 3, 'king': 1, 'goal': 4, 'pawn': 2, 'government': 6, 'TV': 3, 'knight': 1, 'football': 4, 'actor': 2, 'bishop': 6, 'penalty': 2, 'books': 2, 'cinema': 2, 'student': 3, 'president': 2, 'vote': 2, 'lecture': 2, 'corruption': 2, 'exam': 1}, {'king': 2, 'bishop': 1, 'exam': 5, 'pawn': 4, 'government': 5, 'TV': 8, 'movie': 1, 'football': 2, 'actor': 2, 'corruption': 3, 'penalty': 2, 'books': 3, 'cinema': 2, 'student': 1, 'president': 2, 'vote': 2, 'lecture': 2, 'goalkeeper': 1, 'goal': 2}, {'king': 2, 'president': 1, 'exam': 2, 'pawn': 2, 'cinema': 2, 'TV': 2, 'movie': 2, 'government': 2, 'football': 4, 'actor': 1, 'goalkeeper': 3, 'penalty': 7, 'corruption': 1, 'books': 3, 'student': 5, 'knight': 2, 'vote': 3, 'lecture': 4, 'bishop': 1, 'goal': 1}, {'president': 2, 'exam': 4, 'pawn': 3, 'government': 4, 'TV': 5, 'movie': 9, 'football': 1, 'actor': 1, 'goalkeeper': 2, 'penalty': 1, 'books': 3, 'cinema': 4, 'student': 1, 'knight': 1, 'vote': 4, 'lecture': 2, 'bishop': 1, 'goal': 2}, {'goalkeeper': 3, 'king': 2, 'lecture': 6, 'exam': 2, 'government': 2, 'TV': 3, 'movie': 4, 'football': 3, 'actor': 3, 'bishop': 2, 'penalty': 2, 'books': 2, 'cinema': 2, 'student': 3, 'knight': 3, 'vote': 1, 'president': 5, 'corruption': 2}, {'king': 1, 'movie': 1, 'goal': 4, 'cinema': 6, 'TV': 3, 'knight': 3, 'government': 3, 'bishop': 1, 'penalty': 2, 'corruption': 4, 'books': 3, 'student': 1, 'lecture': 4, 'vote': 3, 'president': 4, 'goalkeeper': 4, 'exam': 3}, {'goalkeeper': 3, 'king': 1, 'movie': 2, 'exam': 5, 'government': 5, 'TV': 3, 'knight': 3, 'cinema': 4, 'actor': 1, 'corruption': 3, 'penalty': 1, 'books': 5, 'student': 1, 'president': 2, 'vote': 3, 'lecture': 3, 'bishop': 5}, {'goalkeeper': 1, 'king': 2, 'lecture': 3, 'exam': 4, 'pawn': 1, 'cinema': 8, 'TV': 1, 'knight': 4, 'government': 3, 'football': 2, 'actor': 2, 'bishop': 1, 'penalty': 1, 'student': 5, 'movie': 1, 'vote': 1, 'president': 4, 'corruption': 2, 'goal': 4}, {'king': 6, 'football': 1, 'exam': 2, 'pawn': 1, 'cinema': 2, 'TV': 2, 'knight': 3, 'government': 5, 'actor': 2, 'bishop': 5, 'penalty': 2, 'books': 3, 'student': 5, 'movie': 4, 'vote': 3, 'president': 3, 'corruption': 1}, {'king': 2, 'president': 2, 'exam': 3, 'government': 3, 'TV': 3, 'movie': 1, 'football': 3, 'actor': 3, 'bishop': 7, 'penalty': 4, 'corruption': 1, 'books': 1, 'cinema': 2, 'student': 2, 'knight': 3, 'vote': 4, 'lecture': 1, 'goalkeeper': 2, 'goal': 3}, {'lecture': 4, 'goal': 3, 'cinema': 4, 'TV': 3, 'knight': 2, 'government': 6, 'bishop': 2, 'actor': 2, 'goalkeeper': 2, 'books': 4, 'movie': 7, 'president': 6, 'corruption': 1, 'exam': 4}, {'football': 2, 'lecture': 2, 'goal': 5, 'government': 5, 'TV': 1, 'movie': 4, 'cinema': 5, 'actor': 1, 'bishop': 4, 'penalty': 1, 'books': 4, 'student': 1, 'knight': 2, 'president': 4, 'goalkeeper': 6, 'exam': 3}, {'football': 1, 'exam': 3, 'government': 6, 'TV': 1, 'movie': 8, 'knight': 2, 'cinema': 6, 'actor': 3, 'bishop': 2, 'penalty': 1, 'books': 1, 'lecture': 6, 'vote': 1, 'president': 5, 'goalkeeper': 3, 'goal': 1}, {'king': 2, 'football': 1, 'bishop': 4, 'exam': 2, 'cinema': 4, 'TV': 2, 'movie': 6, 'knight': 1, 'government': 8, 'actor': 2, 'goalkeeper': 1, 'penalty': 1, 'books': 1, 'student': 2, 'lecture': 2, 'vote': 1, 'president': 5, 'corruption': 3, 'goal': 2}, {'king': 1, 'goal': 6, 'government': 4, 'TV': 1, 'movie': 3, 'knight': 2, 'football': 2, 'actor': 2, 'goalkeeper': 2, 'penalty': 3, 'books': 1, 'cinema': 1, 'student': 1, 'president': 4, 'vote': 2, 'lecture': 4, 'bishop': 8, 'exam': 3}, {'king': 4, 'goal': 1, 'pawn': 2, 'cinema': 2, 'bishop': 2, 'knight': 2, 'government': 3, 'football': 5, 'actor': 2, 'goalkeeper': 5, 'penalty': 5, 'books': 1, 'student': 2, 'movie': 2, 'vote': 3, 'president': 1, 'corruption': 3, 'exam': 5}, {'king': 1, 'movie': 2, 'goal': 1, 'pawn': 1, 'government': 4, 'TV': 2, 'knight': 1, 'football': 2, 'actor': 6, 'bishop': 4, 'corruption': 3, 'books': 4, 'cinema': 1, 'student': 1, 'lecture': 3, 'vote': 5, 'president': 4, 'goalkeeper': 4, 'exam': 1}, {'king': 1, 'president': 3, 'exam': 2, 'cinema': 7, 'TV': 2, 'knight': 2, 'government': 7, 'football': 4, 'actor': 2, 'goalkeeper': 1, 'penalty': 2, 'books': 5, 'movie': 2, 'vote': 4, 'lecture': 3, 'bishop': 3}, {'king': 1, 'bishop': 2, 'goal': 5, 'government': 5, 'TV': 3, 'movie': 7, 'knight': 1, 'cinema': 4, 'actor': 1, 'corruption': 2, 'penalty': 1, 'books': 1, 'lecture': 2, 'vote': 1, 'president': 7, 'goalkeeper': 4, 'exam': 3}, {'king': 1, 'president': 5, 'football': 1, 'bishop': 2, 'exam': 4, 'pawn': 1, 'cinema': 2, 'TV': 6, 'movie': 3, 'government': 7, 'actor': 1, 'corruption': 2, 'books': 3, 'student': 1, 'knight': 2, 'vote': 2, 'lecture': 5, 'goalkeeper': 1, 'goal': 1}, {'king': 1, 'lecture': 5, 'goal': 1, 'pawn': 3, 'government': 3, 'TV': 4, 'movie': 5, 'football': 1, 'actor': 2, 'bishop': 3, 'penalty': 3, 'books': 4, 'cinema': 1, 'student': 3, 'knight': 2, 'vote': 3, 'president': 4, 'goalkeeper': 2}, {'king': 3, 'exam': 5, 'pawn': 3, 'government': 2, 'TV': 3, 'movie': 4, 'knight': 1, 'football': 4, 'actor': 1, 'corruption': 4, 'books': 7, 'cinema': 1, 'student': 1, 'president': 2, 'lecture': 3, 'bishop': 3, 'goal': 3}, {'king': 3, 'football': 3, 'exam': 3, 'pawn': 4, 'government': 1, 'TV': 3, 'movie': 4, 'knight': 1, 'cinema': 3, 'actor': 1, 'goalkeeper': 1, 'penalty': 2, 'books': 2, 'student': 2, 'president': 3, 'vote': 6, 'lecture': 3, 'bishop': 3, 'goal': 2}, {'king': 1, 'bishop': 1, 'exam': 4, 'pawn': 2, 'government': 6, 'TV': 3, 'knight': 1, 'cinema': 1, 'actor': 1, 'corruption': 2, 'penalty': 5, 'books': 3, 'student': 2, 'president': 2, 'vote': 2, 'lecture': 4, 'goalkeeper': 7, 'goal': 3}, {'exam': 1, 'pawn': 1, 'cinema': 4, 'TV': 2, 'movie': 4, 'knight': 3, 'football': 3, 'actor': 2, 'corruption': 2, 'penalty': 1, 'books': 5, 'student': 1, 'president': 6, 'vote': 1, 'lecture': 9, 'government': 1, 'goalkeeper': 4}, {'football': 2, 'goal': 6, 'pawn': 2, 'government': 2, 'TV': 4, 'movie': 2, 'knight': 3, 'cinema': 2, 'actor': 6, 'bishop': 2, 'penalty': 3, 'books': 2, 'president': 5, 'vote': 2, 'lecture': 3, 'goalkeeper': 4}, {'king': 1, 'football': 1, 'exam': 4, 'pawn': 1, 'cinema': 8, 'knight': 2, 'government': 6, 'actor': 4, 'goalkeeper': 7, 'books': 1, 'lecture': 5, 'vote': 2, 'president': 5, 'corruption': 1, 'goal': 2}, {'king': 2, 'football': 1, 'lecture': 2, 'goal': 4, 'pawn': 1, 'cinema': 2, 'TV': 3, 'knight': 2, 'government': 1, 'actor': 3, 'goalkeeper': 2, 'corruption': 3, 'books': 5, 'student': 2, 'movie': 5, 'vote': 3, 'president': 2, 'bishop': 4, 'exam': 3}, {'king': 1, 'exam': 4, 'pawn': 4, 'government': 8, 'TV': 1, 'movie': 3, 'actor': 2, 'goalkeeper': 4, 'penalty': 1, 'corruption': 2, 'books': 4, 'student': 2, 'lecture': 2, 'vote': 2, 'president': 6, 'bishop': 3, 'goal': 1}, {'goalkeeper': 1, 'king': 1, 'football': 3, 'lecture': 5, 'goal': 1, 'pawn': 1, 'cinema': 4, 'TV': 5, 'knight': 2, 'government': 3, 'actor': 1, 'corruption': 2, 'penalty': 1, 'books': 3, 'student': 1, 'movie': 5, 'vote': 1, 'president': 4, 'bishop': 5, 'exam': 1}, {'king': 2, 'movie': 1, 'bishop': 1, 'goal': 3, 'pawn': 3, 'government': 3, 'TV': 2, 'knight': 4, 'football': 3, 'actor': 4, 'corruption': 2, 'penalty': 1, 'books': 3, 'student': 2, 'lecture': 5, 'vote': 4, 'president': 3, 'goalkeeper': 2, 'exam': 2}, {'goalkeeper': 1, 'king': 1, 'football': 1, 'lecture': 2, 'exam': 3, 'cinema': 6, 'knight': 8, 'government': 4, 'actor': 3, 'corruption': 4, 'penalty': 2, 'books': 3, 'movie': 4, 'vote': 1, 'president': 2, 'bishop': 2, 'goal': 3}, {'king': 2, 'football': 2, 'goal': 1, 'pawn': 1, 'cinema': 7, 'TV': 3, 'movie': 6, 'government': 2, 'actor': 2, 'bishop': 1, 'penalty': 3, 'corruption': 2, 'books': 3, 'student': 1, 'vote': 1, 'president': 5, 'goalkeeper': 5, 'exam': 3}, {'king': 4, 'football': 2, 'exam': 5, 'pawn': 1, 'cinema': 3, 'TV': 2, 'movie': 1, 'knight': 3, 'government': 2, 'actor': 3, 'corruption': 3, 'penalty': 2, 'student': 3, 'lecture': 2, 'vote': 5, 'president': 3, 'bishop': 4, 'goal': 2}, {'king': 5, 'football': 1, 'lecture': 2, 'goal': 5, 'pawn': 2, 'government': 3, 'TV': 4, 'movie': 5, 'cinema': 2, 'actor': 6, 'goalkeeper': 2, 'penalty': 1, 'corruption': 1, 'books': 1, 'student': 4, 'knight': 3, 'president': 2, 'bishop': 1}, {'king': 1, 'football': 3, 'exam': 3, 'pawn': 1, 'cinema': 7, 'TV': 4, 'movie': 3, 'knight': 3, 'government': 5, 'actor': 1, 'goalkeeper': 3, 'books': 3, 'student': 1, 'president': 1, 'vote': 3, 'lecture': 4, 'corruption': 2, 'goal': 2}, {'king': 1, 'president': 3, 'exam': 3, 'cinema': 1, 'TV': 1, 'knight': 6, 'government': 5, 'football': 2, 'actor': 5, 'goalkeeper': 2, 'penalty': 1, 'corruption': 2, 'books': 4, 'movie': 6, 'vote': 2, 'lecture': 3, 'bishop': 2, 'goal': 1}, {'king': 1, 'bishop': 1, 'exam': 1, 'pawn': 1, 'cinema': 8, 'TV': 7, 'movie': 4, 'knight': 3, 'football': 2, 'corruption': 3, 'penalty': 2, 'books': 2, 'student': 2, 'lecture': 2, 'president': 5, 'government': 3, 'goalkeeper': 3}]]

class Queue(_Queue):
    """ A picklable queue. """
    def __getstate__(self):
        # Only pickle the state we care about
        return (self.maxsize, self.queue, self.unfinished_tasks)

    def __setstate__(self, state):
        # Re-initialize the object, then overwrite the default state with
        # our pickled state.
        Queue.__init__(self)
        self.maxsize = state[0]
        self.queue = state[1]
        self.unfinished_tasks = state[2]


def get_q(q):
    return q


class JobQueueManager(SyncManager):
    pass


class ServerQueueManager(SyncManager):
    pass


def make_server_manager(port, authkey):
    job_q = Queue()
    result_q = Queue()

    JobQueueManager.register('get_job_q', callable=partial(get_q, job_q))
    JobQueueManager.register('get_result_q', callable=partial(get_q, result_q))

    manager = JobQueueManager(address=('127.0.0.1', port), authkey=authkey)
    manager.start()
    print('Server started at port %s' % port)
    return manager


def make_client_manager(IP, port, authkey):
    ServerQueueManager.register('get_job_q')
    ServerQueueManager.register('get_result_q')
    manager = ServerQueueManager(address=(IP, port), authkey=authkey)
    manager.connect()

    print 'Client connected to %s:%s' % (IP, port)
    return manager


def LDA_worker(job_q, result_q):
    """ A worker function to be launched in a separate process. Takes jobs from
        job_q - each job a list of numbers to factorize. When the job is done,
        the result (dict mapping number -> list of factors) is placed into
        result_q. Runs until job_q is empty.
    """
    empty = False
    lda_object =[]
    lda_list =[]
    counter = 0
    first_beta = True
    while True:
        try:
            job = job_q.get_nowait()
            print multiprocessing.current_process()
            if job[0] == "corpus":
                time.sleep(0.01)
                lda_object = job[1]
                lda_list.append(lda_object)
                lda_object.run_LDA()
            elif job[0] == "beta":
                if first_beta:
                    time.sleep(0.01)
                    first_beta = False
                lda_object = lda_list[counter]
                counter = (counter + 1) % len(lda_list)
                lda_object.update_beta(job[1])
                lda_object.run_LDA()
            elif job[0] == "wait":
                pass
            else:
                print "ERROR: Unexpected job"
                return;


            result_q.put(lda_object.beta)
        except:

            return

    return


def mp_work_allocator(shared_job_q, shared_result_q, nprocs):
    """ Split the work with jobs in shared_job_q and results in
        shared_result_q into several processes. Launch each process with
        LDA_worker as the worker function, and wait until all are
        finished.
    """
    start_time = time.time()
    procs = []
    for i in range(nprocs):
        p = multiprocessing.Process(
                target=LDA_worker,
                args=(shared_job_q, shared_result_q))
        procs.append(p)
        p.start()

    for p in procs:
        p.join()

    end_time = time.time()
    print end_time - start_time," seconds"


def runserver():
    # Start a shared manager server and access its queues
    manager = make_server_manager(12397, "test")
    shared_job_q = manager.get_job_q()
    shared_result_q = manager.get_result_q()

    for c in corpus:
        alpha = np.random.uniform(low=0.0, high=1.0, size=5)
        lda_object = ldaObject([[]], c, alpha)
        shared_job_q.put(["corpus",lda_object])

    for j in range(len(corpus)):
        shared_job_q.put(["wait", ""])
    # Wait until all results are ready in shared_result_q
    new_beta = np.zeros((5,20))
    for it in range(100):
        beta_results = []
        beta_sum = np.zeros((5,20))
        #shared_job_q.put(["wait",""])
        while len(beta_results) < len(corpus):
            beta = shared_result_q.get()
            beta_sum += beta
            beta_results.append(beta)
        old_beta = new_beta

        row_sums = beta_sum.sum(axis=1)
        new_beta = beta_sum / row_sums[:, np.newaxis]
        beta_diff = np.sum(abs(np.subtract(new_beta, old_beta)))
        for j in range(len(corpus)):
            shared_job_q.put(["beta", new_beta])
        print "iteration: ", it,"beta difference: ",\
            beta_diff



    # Sleep a bit before shutting down the server - to give clients time to
    # realize the job queue is empty and exit in an orderly way.

    time.sleep(2)

    manager.shutdown()



def runclient():
    manager = make_client_manager("127.0.0.1", 12397, "test")
    job_q = manager.get_job_q()
    result_q = manager.get_result_q()
    mp_work_allocator(job_q, result_q, 4)
